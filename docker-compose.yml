services:
  framedrop:
    image: ghcr.io/camerongarrett/framedrop:latest
    # build: .  # uncomment to build from source instead
    container_name: framedrop
    ports:
      - "443:443"
      - "${DASHBOARD_PORT:-3000}:3000"
    volumes:
      - ${CERT_PATH:-./certs}:/certs
      - ${UPLOAD_PATH:-./uploads}:/uploads
    environment:
      - NAS_IP=${NAS_IP:-192.168.0.100}
      - UPLOAD_DIR=/uploads
      - CERT_DIR=/certs
      - DASHBOARD_PORT=3000
      - LOG_LEVEL=${LOG_LEVEL:-info}
    healthcheck:
      test: ["CMD", "python3", "-c", "import urllib.request; urllib.request.urlopen('http://localhost:3000/api/status')"]
      interval: 30s
      timeout: 5s
      retries: 3
    restart: unless-stopped
